<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0"	xmlns="http://www.w3.org/1999/xhtml"	xmlns:xsl="http://www.w3.org/1999/XSL/Transform">		<xsl:import href="/getTemplate.php/mtg/global"/>	<xsl:import href="/getTemplate.php/core/graph"/>	<xsl:template match="/data">		<html>			<xsl:call-template name="sites.head"/>			<body>				<main>					<h1>DCI Planeswalker Points</h1>					<form method="POST" action="./">						<fieldset>							<legend>Upload</legend>							<textarea name="html" placeholder="&lt;!DOCTYPE html&gt;"/>							<button type="submit">Upload!</button>						</fieldset>					</form>					<xsl:apply-templates select=".//dci"/>				</main>			</body>		</html>	</xsl:template>		<xsl:template match="dci">		<xsl:variable name="matchList" select="match"/>		<xsl:variable name="formatList" select="format"/>		<xsl:variable name="opponentList" select="opponent"/>		<xsl:variable name="storeList" select="store"/>		<details>			<summary><xsl:value-of select="@number"/></summary>			<div>				<a class="graph-wrapper" href="Timeline/?dci={current()/@number}" target="_blank">					<xsl:apply-templates select="//graph[@_dci = current()/@number]"/>				</a>				<a href="http://www.wizards.com/Magic/PlaneswalkerPoints/{@number}">PlaneswalkerPoints</a>				<table class="dci">					<thead>						<tr>							<th>Total</th>							<th>Opponent</th>							<xsl:for-each select="$formatList">								<th><xsl:value-of select="@name"/></th>							</xsl:for-each>							<th/>						</tr>						<tr>							<th>								<code>									<xsl:value-of select="count($matchList[@result = 'Win'])"/>									<xsl:text>-</xsl:text>									<xsl:value-of select="count($matchList[@result = 'Loss'])"/>									<xsl:text>-</xsl:text>									<xsl:value-of select="count($matchList[@result = 'Draw'])"/>								</code>							</th>							<th/>							<xsl:for-each select="$formatList">								<xsl:variable name="format" select="@name"/>								<xsl:variable name="matchListFormat" select="$matchList[@format = $format]"/>								<xsl:variable name="winList" select="$matchListFormat[@result = 'Win']"/>								<xsl:variable name="lossList" select="$matchListFormat[@result = 'Loss']"/>								<xsl:variable name="drawList" select="$matchListFormat[@result = 'Draw']"/>								<th>									<code data-dci-record="{number(count($winList) &gt; count($lossList))}">										<xsl:value-of select="count($winList)"/>										<xsl:text>-</xsl:text>										<xsl:value-of select="count($lossList)"/>										<xsl:text>-</xsl:text>										<xsl:value-of select="count($drawList)"/>									</code>								</th>							</xsl:for-each>							<td>								<xsl:for-each select="$storeList">									<xsl:if test="position() &gt; 1">										<xsl:text>, </xsl:text>									</xsl:if>									<em><xsl:value-of select="@name"/></em>								</xsl:for-each>							</td>						</tr>					</thead>					<tbody>						<xsl:for-each select="$opponentList">							<!--<xsl:sort select="count($matchList[@opponent = current()/@name])" data-type="number" order="descending"/>-->							<xsl:sort select="@name"/>							<xsl:variable name="opponent" select="@name"/>							<xsl:variable name="matchListOpponent" select="$matchList[@opponent = $opponent]"/>							<tr data-wins="{count($matchListOpponent[@result = 'Win'])}" data-losses="{count($matchListOpponent[@result = 'Loss'])}" data-draws="{count($matchListOpponent[@result = 'Draw'])}">								<td>									<code>										<xsl:value-of select="count($matchListOpponent[@result = 'Win'])"/>										<xsl:text>-</xsl:text>										<xsl:value-of select="count($matchListOpponent[@result = 'Loss'])"/>										<xsl:text>-</xsl:text>										<xsl:value-of select="count($matchListOpponent[@result = 'Draw'])"/>									</code>								</td>								<th>									<xsl:value-of select="@name"/>								</th>								<xsl:for-each select="$formatList">									<xsl:variable name="format" select="@name"/>									<xsl:variable name="matchListFormat" select="$matchListOpponent[@format = $format]"/>									<xsl:variable name="winList" select="$matchListFormat[@result = 'Win']"/>									<xsl:variable name="lossList" select="$matchListFormat[@result = 'Loss']"/>									<xsl:variable name="drawList" select="$matchListFormat[@result = 'Draw']"/>									<td data-wins="{count($winList)}" data-losses="{count($lossList)}" data-draws="{count($drawList)}">										<code>											<xsl:value-of select="count($winList)"/>											<xsl:text>-</xsl:text>											<xsl:value-of select="count($lossList)"/>											<xsl:text>-</xsl:text>											<xsl:value-of select="count($drawList)"/>										</code>									</td>								</xsl:for-each>								<td>									<xsl:for-each select="$storeList[@name = $matchListOpponent/@store]">										<xsl:if test="position() &gt; 1">											<xsl:text>, </xsl:text>										</xsl:if>										<em><xsl:value-of select="@name"/></em>									</xsl:for-each>								</td>							</tr>						</xsl:for-each>					</tbody>				</table>			</div>		</details>	</xsl:template></xsl:stylesheet>